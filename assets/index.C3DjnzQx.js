import{j as e,L as M,b as o,E as N,C as O,B as D,d as I,f as v,e as C}from"./index.Cgek468Y.js";import{c as J,i as Q,b as t,L as R}from"./vendor.CrEiiG9O.js";import{i as G,a as H}from"./validations.Bz6ar0SR.js";import{E as P}from"./eye-off.n_IBP84p.js";function Z(){const d=J(),[S]=Q(),l=S.get("mail"),[K,L]=t.useState(null),[c,n]=t.useState(""),[i,p]=t.useState(""),[m,h]=t.useState(""),[u,E]=t.useState(""),[g,F]=t.useState(""),[b,T]=t.useState(!1),[f,q]=t.useState(!1),[y,V]=t.useState(!1),[k,x]=t.useState(!1),[a,w]=t.useState({name:"",telephone:"",adresse:"",email:"",password:"",confirmPassword:"",acceptTerms:"",submit:""});t.useEffect(()=>{if(!l){d("/login",{replace:!0});return}(async()=>{try{const s=await v.getPartnerByEmail(l);if(L(s||null),s?.password){d("/login",{replace:!0});return}s?.name&&n(s.name),s?.partner_phone&&p(s.partner_phone),s?.partner_city&&h(s.partner_city)}catch(s){console.error("getPartnerByEmail error:",s)}})()},[l,d]);const B=(r,s)=>r?r.length<6?"Le mot de passe doit contenir au moins 6 caractères.":r!==s?"Les mots de passe ne correspondent pas.":"":"Le mot de passe est obligatoire.",z=()=>{const r={name:c?"":"Le nom complet est obligatoire.",telephone:i?G(i)?"":"Le numéro de téléphone est invalide (ex: +221 77 000 00 00).":"Le téléphone est obligatoire.",adresse:m?"":"L'adresse est obligatoire.",email:l?H(l)?"":"L'adresse email est invalide.":"L'adresse email est obligatoire.",password:B(u,g),confirmPassword:"",acceptTerms:y?"":"Veuillez accepter les conditions d’utilisation.",submit:""};return w(r),Object.values(r).every(s=>!s)},A=async r=>{if(r.preventDefault(),x(!0),!z()){x(!1);return}try{const s={name:c,email:l,adresse:m,password:u,telephone:i};await v.createPasswordPartner(s),C.success("Compte créé avec succès. Veuillez vérifier votre boîte mail.",{position:"top-center",autoClose:5e3}),d("/login",{replace:!0})}catch(s){const j=s?.response?.data?.error||s?.response?.data?.message||"Échec de la création du compte.";w(_=>({..._,submit:j})),C.error(j,{position:"top-center",autoClose:5e3})}finally{x(!1)}};return e.jsx(M,{children:e.jsx("div",{className:"w-full min-h-[80vh] flex items-center justify-center px-4 py-10",children:e.jsx("div",{className:"w-full max-w-lg",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 border border-[#E0E0E0] dark:border-gray-700 rounded-lg shadow-md",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-qblack dark:text-white",children:"Créer un compte"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Activez votre accès sécurisé"}),a.submit&&e.jsx("p",{className:"mt-3 text-sm text-red-600 dark:text-red-400",children:a.submit})]}),e.jsxs("form",{onSubmit:A,className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"company",className:"mb-2 block text-sm font-medium",children:"Nom de l’entreprise"}),e.jsx("input",{id:"company",type:"text",value:c,onChange:r=>n(r.target.value),placeholder:"Entreprise",required:!0,className:"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-slate-300 dark:border-gray-600 rounded-md text-sm shadow-sm placeholder-slate-400 dark:placeholder-gray-400 focus:outline-none focus:border-black focus:ring-1 focus:ring-black/20 dark:focus:border-gray-300 dark:focus:ring-gray-300 text-gray-900 dark:text-white"}),a.name&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:a.name})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"fullname",className:"mb-2 block text-sm font-medium",children:"Nom complet"}),e.jsx("input",{id:"fullname",type:"text",value:c,onChange:r=>n(r.target.value),placeholder:"Nom complet",required:!0,className:"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-slate-300 dark:border-gray-600 rounded-md text-sm shadow-sm placeholder-slate-400 dark:placeholder-gray-400 focus:outline-none focus:border-black focus:ring-1 focus:ring-black/20 dark:focus:border-gray-300 dark:focus:ring-gray-300 text-gray-900 dark:text-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"email",className:"mb-2 block text-sm font-medium",children:"Email"}),e.jsx("input",{id:"email",type:"email",value:l||"",disabled:!0,className:"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-slate-300 dark:border-gray-600 rounded-md text-sm shadow-sm placeholder-slate-400 dark:placeholder-gray-400 focus:outline-none text-gray-900 dark:text-white opacity-70"}),a.email&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:a.email})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"phone",className:"mb-2 block text-sm font-medium",children:"Téléphone"}),e.jsx("input",{id:"phone",type:"text",value:i,onChange:r=>p(r.target.value),placeholder:"+221 77 000 00 00",required:!0,className:"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-slate-300 dark:border-gray-600 rounded-md text-sm shadow-sm placeholder-slate-400 dark:placeholder-gray-400 focus:outline-none focus:border-black focus:ring-1 focus:ring-black/20 dark:focus:border-gray-300 dark:focus:ring-gray-300 text-gray-900 dark:text-white"}),a.telephone&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:a.telephone})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"adresse",className:"mb-2 block text-sm font-medium",children:"Adresse"}),e.jsx("input",{id:"adresse",type:"text",value:m,onChange:r=>h(r.target.value),placeholder:"Ville / Quartier",required:!0,className:"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-slate-300 dark:border-gray-600 rounded-md text-sm shadow-sm placeholder-slate-400 dark:placeholder-gray-400 focus:outline-none focus:border-black focus:ring-1 focus:ring-black/20 dark:focus:border-gray-300 dark:focus:ring-gray-300 text-gray-900 dark:text-white"}),a.adresse&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:a.adresse})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"password",className:"mb-2 block text-sm font-medium",children:"Mot de passe"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",type:b?"text":"password",value:u,onChange:r=>E(r.target.value),placeholder:"Mot de passe",required:!0,className:"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-slate-300 dark:border-gray-600 rounded-md text-sm shadow-sm placeholder-slate-400 dark:placeholder-gray-400 focus:outline-none focus:border-black focus:ring-1 focus:ring-black/20 dark:focus:border-gray-300 dark:focus:ring-gray-300 text-gray-900 dark:text-white"}),e.jsx("button",{type:"button",onClick:()=>T(r=>!r),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 dark:text-gray-300",children:b?e.jsx(N,{className:"h-5 w-5"}):e.jsx(P,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"confirm",className:"mb-2 block text-sm font-medium",children:"Confirmation"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"confirm",type:f?"text":"password",value:g,onChange:r=>F(r.target.value),placeholder:"Confirmer le mot de passe",required:!0,className:"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-slate-300 dark:border-gray-600 rounded-md text-sm shadow-sm placeholder-slate-400 dark:placeholder-gray-400 focus:outline-none focus:border-black focus:ring-1 focus:ring-black/20 dark:focus:border-gray-300 dark:focus:ring-gray-300 text-gray-900 dark:text-white"}),e.jsx("button",{type:"button",onClick:()=>q(r=>!r),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 dark:text-gray-300",children:f?e.jsx(N,{className:"h-5 w-5"}):e.jsx(P,{className:"h-5 w-5"})})]})]})]}),a.password&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 -mt-2",children:a.password}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{id:"terms",checked:y,onChange:()=>V(r=>!r)}),e.jsx(o,{htmlFor:"terms",className:"text-sm",children:"J’accepte les conditions d’utilisation"})]}),a.acceptTerms&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 -mt-2",children:a.acceptTerms}),e.jsx(D,{type:"submit",className:"w-full bg-black hover:bg-black/90 text-white font-medium py-2.5 disabled:opacity-60",disabled:k,children:k?e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4 animate-spin"})," Création du compte…"]}):"Créer un compte"}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-white dark:text-gray-600",children:["Vous avez déjà un compte ?",e.jsx(R,{to:"/login",className:"ml-1 underline",children:"Se connecter"})]})})]})]})})})})}export{Z as default};
