import{j as e,L as B,b as l,T as d,E as j,C as q,d as R,e as f,f as V}from"./index.eWEbYf7N.js";import{c as z,b as m,L as M}from"./vendor.CrEiiG9O.js";import{i as A,a as D}from"./validations.Bz6ar0SR.js";import{E as k}from"./eye-off.CRoTanUS.js";function $(){const o="#487a43",N="#3e6c3b",v=z(),[t,C]=m.useState({name:"",email:"",city:"",phone:"",password:"",confirmPassword:"",acceptTerms:!1}),[p,L]=m.useState(!1),[h,S]=m.useState(!1),[g,w]=m.useState(!1),[r,y]=m.useState({name:"",email:"",city:"",phone:"",password:"",confirmPassword:"",acceptTerms:"",submit:""}),i=s=>{const{name:a,value:x,type:u,checked:b}=s.target;C(F=>({...F,[a]:u==="checkbox"?b:x}))},T=()=>{const s={name:t.name?"":"Le nom est obligatoire.",email:t.email?D(t.email)?"":"L'adresse email est invalide.":"L'adresse email est obligatoire.",city:t.city?"":"L'adresse est obligatoire.",phone:t.phone?A(t.phone)?"":"Le numéro de téléphone est invalide (ex: +221 77 000 00 00).":"Le téléphone est obligatoire.",password:t.password?t.password.length<6?"Le mot de passe doit contenir au moins 6 caractères.":"":"Le mot de passe est obligatoire.",confirmPassword:t.password!==t.confirmPassword?"Les mots de passe ne correspondent pas.":"",acceptTerms:t.acceptTerms?"":"Veuillez accepter les conditions d’utilisation.",submit:""};return y(s),Object.values(s).every(a=>!a)},P=s=>{const a=String(s).replace(/\D/g,"");return a.startsWith("221")?a:"221"+a},E=async s=>{if(s.preventDefault(),!T()){f.error("Création du compte impossible : formulaire invalide.",{position:"top-center"});return}w(!0);const a={name:t.name.trim(),email:t.email.trim(),password:t.password,city:t.city.trim(),phone:P(t.phone)};console.log(a);try{await V.createUser(a),f.success("Compte créé ! Veuillez vérifier le code OTP envoyé par email.",{position:"top-center",autoClose:5e3}),v(`/verification-code?email=${encodeURIComponent(t.email)}`,{replace:!0})}catch(x){const u=x?.response?.data?.message||x?.response?.data||"Une erreur s'est produite.";y(b=>({...b,submit:u})),f.error(String(u),{position:"top-center"})}finally{w(!1)}},n=s=>s.currentTarget.style.boxShadow=`0 0 0 2px ${o}33`,c=s=>s.currentTarget.style.boxShadow="none";return e.jsx(B,{children:e.jsx("div",{className:"w-full flex items-start justify-center px-4 py bg-gray-50",children:e.jsx("div",{className:"w-full max-w-lg",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 border border-[#E0E0E0] dark:border-gray-700 rounded-lg shadow-md",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full mx-auto flex items-center justify-center shadow-sm",style:{backgroundColor:o},"aria-hidden":!0,children:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-7 h-7 text-white",fill:"currentColor",children:e.jsx("path",{d:"M12 3l9 8h-3v8h-5v-5H11v5H6v-8H3l9-8z"})})}),e.jsx("h1",{className:"mt-3 text-2xl font-bold",style:{color:o},children:"Créer un compte"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Renseignez vos informations"}),r.submit&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-3",children:r.submit})]}),e.jsxs("form",{onSubmit:E,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"name",className:"mb-2 block text-sm font-medium",children:"Nom complet"}),e.jsx(d,{id:"name",name:"name",value:t.name,onChange:i,placeholder:"Nom complet",required:!0,onFocus:n,onBlur:c,theme:{field:{input:{base:"block w-full border bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}}}}),r.name&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:r.name})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"email",className:"mb-2 block text-sm font-medium",children:"Email"}),e.jsx(d,{id:"email",name:"email",type:"email",value:t.email,onChange:i,placeholder:"email@exemple.com",required:!0,onFocus:n,onBlur:c,theme:{field:{input:{base:"block w-full border bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}}}}),r.email&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:r.email})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"city",className:"mb-2 block text-sm font-medium",children:"Adresse"}),e.jsx(d,{id:"city",name:"city",value:t.city,onChange:i,placeholder:"Ville / Quartier",required:!0,onFocus:n,onBlur:c,theme:{field:{input:{base:"block w-full border bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}}}}),r.city&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:r.city})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"phone",className:"mb-2 block text-sm font-medium",children:"Téléphone"}),e.jsx(d,{id:"phone",name:"phone",value:t.phone,onChange:i,placeholder:"+221 77 000 00 00",required:!0,onFocus:n,onBlur:c,theme:{field:{input:{base:"block w-full border bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}}}}),r.phone&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:r.phone})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"password",className:"mb-2 block text-sm font-medium",children:"Mot de passe"}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{id:"password",name:"password",type:p?"text":"password",value:t.password,onChange:i,placeholder:"••••••••",required:!0,className:"pr-10",onFocus:n,onBlur:c,theme:{field:{input:{base:"block w-full border bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}}}}),e.jsx("button",{type:"button",onClick:()=>L(s=>!s),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 dark:text-gray-300","aria-label":p?"Masquer":"Afficher",children:p?e.jsx(k,{className:"h-5 w-5"}):e.jsx(j,{className:"h-5 w-5"})})]}),r.password&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:r.password})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"confirmPassword",className:"mb-2 block text-sm font-medium",children:"Confirmer le mot de passe"}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{id:"confirmPassword",name:"confirmPassword",type:h?"text":"password",value:t.confirmPassword,onChange:i,placeholder:"••••••••",required:!0,className:"pr-10",onFocus:n,onBlur:c,theme:{field:{input:{base:"block w-full border bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}}}}),e.jsx("button",{type:"button",onClick:()=>S(s=>!s),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 dark:text-gray-300","aria-label":h?"Masquer":"Afficher",children:h?e.jsx(k,{className:"h-5 w-5"}):e.jsx(j,{className:"h-5 w-5"})})]}),r.confirmPassword&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:r.confirmPassword})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{id:"terms",name:"acceptTerms",checked:t.acceptTerms,onChange:i,style:{accentColor:o}}),e.jsx(l,{htmlFor:"terms",className:"text-sm",children:"J’accepte les conditions d’utilisation"})]}),r.acceptTerms&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 -mt-2",children:r.acceptTerms}),e.jsx("button",{type:"submit",disabled:g,className:"w-full flex items-center justify-center text-white font-medium py-2.5 px-4 rounded-md focus:outline-none transition disabled:opacity-60",style:{backgroundColor:o},onMouseEnter:s=>s.currentTarget.style.backgroundColor=N,onMouseLeave:s=>s.currentTarget.style.backgroundColor=o,children:g?e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4 animate-spin"}),"Création du compte…"]}):"Créer un compte"}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-white dark:text-gray-600",children:["Vous avez déjà un compte ?",e.jsx(M,{to:"/login",className:"ml-1 underline",style:{color:o},children:"Se connecter"})]})})]})]})})})})}export{$ as default};
